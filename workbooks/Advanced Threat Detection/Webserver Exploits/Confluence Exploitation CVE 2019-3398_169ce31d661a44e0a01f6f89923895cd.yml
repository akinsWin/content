id: 169ce31d661a44e0a01f6f89923895cd
name: Confluence Exploitation CVE-2019-3398
path: /Advanced Threat Detection/Webserver Exploits
description: ''
type: standard
author: community
entity_type: workbooks
blocks:
- type: text
  code: "|Author|References|\n                 |------|--------|\n               \
    \  |Florian Roth|https://devcentral.f5.com/s/articles/confluence-arbitrary-file-write-via-path-traversal-cve-2019-3398-34181|"
- type: sql
  query: SELECT * FROM WEBSERVER WHERE $Method='POST' AND ($URL LIKE "%upload.action%")
    AND ($URL LIKE "%filename=../../../../%") AND $Status='PASSED' AND $Action='REQUEST_ALLOWED'
- type: signal
  DetectionName: Confluence Exploitation CVE-2019-3398
  DetectionTactic: Initial Access
  DetectionTechnique: Exploit Public-Facing Application
  DetectionScore: 5
  DetectionSeverity: Medium
  DetectionConfidence: Low
  TargetHost: $System
  raw_event_query: SELECT * FROM WEBSERVER WHERE $Duration=5m AND $System='{TargetHost}'
    LIMIT 1000
